# Встроенное приложение "Дашборды"
Встроенное приложение для построения оперативной отчетности

## Release Notes
### 1.0.11
* технический релиз, исправление багов и мелкие доработки

### 1.0.10
* Переход дрилл-даун в список объектов с виджета-сводки теперь возможен по клику на само число;
* В таблице добавлена сортировка по столбцу параметра и автоподбор ширины столбца с номерами строк;
* Внесены правки для корректного отображения дашборда при экспорте;
* Исправлена ошибка сортировки при активном чек-боксе ТОП;
* Доработан переход дашборда в полноэкранный режим для версий платформы от 4.12;
* Изменена архитектура модулей и механизм перемещения виджетов по дашборду;
* Для типа виджета спидометр расширен функционал интервалов: добавлена возможность указывать дробные , отрицательные числа.

### 1.0.9
* Переработана вкладка стиль: для виджета таблица добавлены новые возможности настройки стиля - отдельно настройка шрифта для заголовка таблицы и тела таблицы;
* Также на вкладке стиль теперь доступна настройка осей для комбо диаграммы: добавлена возможность именования для любой оси, гибкая настройка сортировки посредством добавления функции выбора источника;
* Реализована навигация на дашбордах - добавлена возможность настройки перехода с виджета на другой виджет;
* Реализована новая функция вывода TOP значений показателя для всех видов диаграмм;
* Отправка дашборда на e-mail теперь доступна на любой адрес (ранее только на адреса сотрудников, зафиксированных в системе);
* Для виджета типа таблица убрано ограничение выводимых значений (ранее было ограничение в 100 строк), добавлены “заглушки” препятствующие подписанию виджета  в случае большого количество строк или столбцов;
* Реализована валидация количества источников в зависимости от типа виджета;
* Реализовано отображение нулевых значений на комбо диаграмме, а также в легенде;
* Исправлены ошибки вкладки стиль, отображения подписей (добавлен перенос подписей и наклон при необходимости), исправлено поведение при выводе вычисляемого атрибута ( в случае непредвиденного деления на 0), ошибки при построении виджета на основе справочников и относительных критериев фильтрации, а также ошибка отсутствия ограничения на кол-во виджетов на дашборде при добавлении их копированием;
* Исправлена ошибка экспорта таблицы в XLS (с разбивкой выгружались не все данные).

### 1.0.8
* теперь на дашборд можно добавить не только диаграмму, но и текст, настроив его стиль по своему усмотрению;
* появилась возможность вывести нулевые столбцы при использовании кастомной группировки;
* оптимизированы интерфейс и возможности настройки комбо-диаграммы и таблицы (можно настроить шкалы для каждой из осей, установить количество строк на одной странице таблицы и т.д);
* при построении виджета по типу учитываются не только его объекты, но и объекты вложенных подтипов;
* исключена возможность построения виджетов оп атрибутам типа счётчик;
* реализован дрилл-даун с ячейки таблицы с агрегацией N/A ссылочного атрибута на карточку объекта;
* усовершенствованы настройки стиля для виджетов типа сводка и спидометр;
* добавлена подгонка высота айфрейма под высоту контента для избавления от двойных скроллов.

### 1.0.7
* пользователи из группы с кодом dashboardMaster стали учитываться как Мастера дашбордов (подготовка к созданию системной группы пользователей dashboardMaster)
* реализована возможность отправки файла с дашбордом на e-mail любого сотрудника
* добавлен функционал учета/неучета данных с незаполненными атрибутами (null)
* откорректировано построение виджета, в котором в качестве источника выбран тип с вложенными подтипами
* в интерфейсе просмотра дашборда устранены отступы слева и справа от границы контента до виджетов, теперь правая панель редактирования появляется поверх дашборда
* исправлено отображение виджетов и переключение режима для Личного дашборда
* заменена иконка для виджета-спидометра
* исправлена ошибка с подгрузкой только системных статусов при создании пользовательской группировки
* добавлена возможность вывести заголовок в нижней части виджета
* реализован вывод легенды в строку для ее расположения в верхней и нижней частях виджета
* теперь по умолчанию легенда выводится только на тех виджетах, где установлена разбивка
* изменена иконка фильтра на правой панели для более наглядного отображения того, применена фильтрация к источнику или нет
* размер показателя в сводке по умолчанию уменьшен до 60

### 1.0.6
* Появилась возможность построения виджета по некоторым типам динамических атрибутов (строки, даты, временной * интервал)
* Модернизирован виджет-таблица: теперь можно использовать для построения таблицы несколько источников, в качестве параметра выбрать несколько атрибутов и выбрать для каждого из них группировку, вывести неагрегированные данные,*  перейти на список объектов drill-down с каждой ячейки
* Добавлена агрегация “Среднее значение” для нечисловых атрибутов типа элемент справочника, ссылка на БО, обратная * ссылка, набор ссылок на БО, набор элементов справочника
* Реализовано применение пользовательских группировок одновременно в параметре и разбивке показателя
* Работает drill-down для новых типов группировок по датам
* Переименованы пакеты в модулях для избежания конфликтов имен с методами в других модулях
* Изменен интерфейс панели управления на виджете
* На комбо-диаграмме выведены оси для каждого из показателей
* Реализована возможность использования переменных в заголовках виджетов
* Заменены методы для возможности лицензирования ВП Дашборды
* Появилась возможность копирования виджетов для суперпользователей и мастера даш

### 1.0.5
* Добавлены новые типы форматирования по датам (без дриллдауна)
* Добавлена агрегация для атрибута временной интервал
* Реализован новый тип виджета "Спидометр"
* Изменены поля наименования виджета, добавлен функционал уникальности названий
* Исправлен bug: не отображалась кастомная группировка в разбивке
* Добавлена всплывающая подсказка в панели настройки кастомных группировок
* В виджете типа таблица при установленной агрегации %- исправлено отображение значений.
* Не сохраняется вычислимое поле, если оно заканчивается математическим действием
* Добавлена возможность использования дробных констант в вычислимом поле
* Добавлено значение по умолчанию - уникальный идентификатор в параметре показатель
* Переработано модальное окно в части дизайна.
* Исправлены ошибки при построении виджета(кастомная группировка с разбивкой), ошибка загрузка данных при использовании в настройках атрибута "Уникальный идентификатор" в параметре показатель,  при использовании в настройках формулы в вычислимом поле и разбивки

### 1.0.4
* добавлена возможность построения диаграмм по атрибутам типа Счётчик и Обратный счётчик, а также по Логическому атрибуту и атрибуту типа Метакласс;
* ограничен размер возвращаемого датасета для построения диаграмм (100 строками);
* исправлен некорректный переход на список объектов с виджета, построенного с использованием кастомной группировки;
* реализована возможность использования атрибута связанного объекта при построении  диаграмм;
* осуществлен переход на работу с новым ApiCriteria (это значит, что эта и последующие версии ВП Дашборды будут работать на тех версиях, в которые входит задача по новому ApiCriteria);
* переработана вкладка "Стиль" на панели создания/редактирования виджета (в т.ч. расширены возможности пользовательской настройки стилей);
* реализована корректная работа функции "Разбивка" в диаграммах, построенных с использованием вычислений;

### 1.0.3
* добавлена возможность настройки пользователем собственных группировок для всех типов атрибутов (например, теперь пользователь может вывести на диаграмму группы по статусам запросов “открыт”, “закрыт” и “прочие”, настроив группу самостоятельно все, что должно попасть в группу “прочие”);
* добавлено явное разделение вида дашборда на “общий” (т.е. системный, настроенный Мастером дашбордов для всех) и “мой” (т.е. личный, тот, на который любой пользователь может вносить изменения и дополнения);
* доработан тип форматирования “7 дней” для атрибута типа дата (дата/время) для применения в вычислимом поле;
* появился экспорт виджета-таблицы в формат .xlsx;
* реализовано сохранение настроенной пользователем ширины столбцов для виджета-таблицы;
* добавлены всплывающие подсказки с названиями типов виджетов;
* доработана возможность выбора в качестве атрибута ссылочного атрибута ссылки (набора ссылок) на бизнес-объект, метакласса, элемента (набора элементов) справочника, обратной ссылки и статуса

### 1.0.2
* во все типы виджетов добавлена возможность использования вычислений  (ранее она была доступна только в комбинированной диаграмме);
* созданные в виджете вычисления теперь можно отредактировать;
* для поддержания производительности на должном уровне максимально возможное количество виджетов на одном дашборде ограничено 30-ю;
* реализована функциональность задания пользователем интервала времен автоматического обновления информации во всех виджетах дашборда;
* при переходе с виджета на список объектов (дрилл-даун) появилась проверка на наличие указанного для этого типа объектов шаблона списка, что позволяет для каждого метакласса открыть список в соответствии с его шаблоном

### 1.0.1
* построение диаграммы на основе adv-листа;
* возможность задания атрибута ссылочного атрибута для вывода на оси;
* багофикс;
* прочие мелкие улучшения.

### 1.0.0
Реализовано создание графических отчетов (виджетов) на основе объектной модели SMP.
Доступные для создания типы виджетов:
* столбчатая диаграмма;
* параметризованная столбчата диаграмма;
* гистограмма;
* параметризованная гистограмма;
* круговая диаграмма (бублик и пирог);
* линейный график;
* комбинированная диаграмма;
* таблица;
* сводка.

Для комбинированной диаграммы реализована возможность создания и использования для построения диаграммы вычислимых полей.
Доступен экспорт дашбордов в следующие форматы:
* PNG
* PDF

Также есть возможность отправки экспортированного дашборда на почту.

## Требования

1. `node.js` версии `6` или выше
1. `npm` версии `4.5` или выше

## Установка, настройка и сборка

### Установка

```bash
$ npm i
```

Эта команда устанавливает все необходимые пакеты для разработки и сборки встраиваемого приложения.

### Настройка

Необходимо отредактировать файлы `readme.md` и `package.json`, которые находятся в корневой папке разрабатываемого приложения:

- в `readme.md` поместить описание создаваемого приложения, особенности его сборки, настройки и использования;
- в `package.json` нужно отредактировать поля `author`, `bugs`, `description`, `homepage`, `keywords`, `name` и `version` так, чтобы они содержали актуальные значения.

### Сборка для разработки

```bash
$ npm run dev
```

Сценарий `dev` собирает модули в итоговую сборку и держит ее в памяти. Результат можно увидеть в браузере по адресу `http://ваш-ip-адрес:8080`. При изменении каких либо исходных файлов (кроме конфигурационных), запустится процесс пересборки и после его окончания страница в браузере обновится.

### Сборка для эксплуатации

```bash
$ npm run build
```

Сценарий `build` перед началом сборки выполняет очистку папки `dist` в корне проекта от файлов предыдущей сборки, создает файлы новой сборки в папке `dist`, а после окончания сборки создает архив `dist-DD-MM-YYYY HH-mm-SS.zip` из файлов в папке `dist`, где `DD-MM-YYYY` - дата в формате `день-месяц-год`, а `HH-mm-SS` - время в формате `часы-минуты-секунды`.

## Прочие сценарии

Помимо сценариев `dev` и `build` существуют еще сценарии `flow`, `lint`, `test` и `test:watch`.

`flow` запускает статическую проверку типов. `lint` проверяет код на соответствие стилю написания кода. `test` запускает тесты, а `test:watch` запускает тесты в режиме наблюдения: при изменении файлов тесты будут перезапускаться.

## Разработка встраиваемого приложения

При разработке приложения код следует располагать в папке `src`, а в папке `tests` - тесты.

## Тестирование

При написании тестов `flow` может работать некорректно. Чтобы это исправить, необходимо выполнить команду:

```bash
$ flow-typed install jest@версия-jest-указанная-в-package.json
```

## Совместимость

Система сборки (`webpack@4`) и утилита преобразования `ES6` (`babel`) в `JavaScript` не подразумевают работу результата в `Internet Explorer 8`.
